property_overrides: (( merge ))
base_releases:
  - name: etcd
    version: (( release_versions.etcd || "latest" ))

base_job_templates:
  database:
    - name: etcd
      release: etcd
  collocated:
    - name: etcd
      release: etcd

properties:
  etcd:
    machines: ["etcd.service.cf.internal"]
    advertise_urls_dns_suffix: "etcd.service.cf.internal"
    cluster:
      - name: "database_z1"
        instances: (( instance_count_overrides.database_z1.instances || 1 ))
      - name: "database_z2"
        instances: (( instance_count_overrides.database_z2.instances || 1 ))
      - name: "database_z3"
        instances: (( instance_count_overrides.database_z3.instances || 1 ))
      - name: "colocated_z1"
        instances: (( instance_count_overrides.colocated_z1.instances || 0 ))
      - name: "colocated_z2"
        instances: (( instance_count_overrides.colocated_z2.instances || 0 ))
      - name: "colocated_z2"
        instances: (( instance_count_overrides.colocated_z2.instances || 0 ))
    require_ssl: (( property_overrides.etcd.require_ssl || nil ))
    ca_cert: (( property_overrides.etcd.ca_cert || nil ))
    server_cert: (( property_overrides.etcd.server_cert || nil ))
    server_key: (( property_overrides.etcd.server_key || nil ))
    client_cert: (( property_overrides.etcd.client_cert || nil ))
    client_key: (( property_overrides.etcd.client_key || nil ))
    peer_require_ssl: (( property_overrides.etcd.peer_require_ssl || nil ))
    peer_ca_cert: (( property_overrides.etcd.peer_ca_cert || nil ))
    peer_cert: (( property_overrides.etcd.peer_cert || nil ))
    peer_key: (( property_overrides.etcd.peer_key || nil ))
    heartbeat_interval_in_milliseconds: (( property_overrides.etcd.heartbeat_interval_in_milliseconds || nil ))
    election_timeout_in_milliseconds: (( property_overrides.etcd.election_timeout_in_milliseconds || nil ))
  diego:
    bbs:
      etcd:
        machines: (( properties.etcd.machines ))
        require_ssl: (( property_overrides.etcd.require_ssl || nil ))
        ca_cert: (( property_overrides.etcd.ca_cert ))
        client_cert: (( property_overrides.etcd.client_cert ))
        client_key: (( property_overrides.etcd.client_key ))
        client_session_cache_size: (( property_overrides.etcd.client_session_cache_size || nil ))
        max_idle_conns_per_host: (( property_overrides.etcd.max_idle_conns_per_host || nil ))

